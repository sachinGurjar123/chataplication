[{"/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/index.js":"1","/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/App.js":"2","/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/reportWebVitals.js":"3","/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/ChatUi.js":"4","/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/SocketConnection.js":"5","/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/style.js":"6"},{"size":535,"mtime":1674205412863,"results":"7","hashOfConfig":"8"},{"size":161,"mtime":1674647700545,"results":"9","hashOfConfig":"8"},{"size":362,"mtime":1674205412863,"results":"10","hashOfConfig":"8"},{"size":5642,"mtime":1674655274310,"results":"11","hashOfConfig":"8"},{"size":808,"mtime":1674648901672,"results":"12","hashOfConfig":"8"},{"size":1837,"mtime":1674648747312,"results":"13","hashOfConfig":"8"},{"filePath":"14","messages":"15","suppressedMessages":"16","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"ma5z84",{"filePath":"17","messages":"18","suppressedMessages":"19","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"20","messages":"21","suppressedMessages":"22","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"23","messages":"24","suppressedMessages":"25","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"26"},{"filePath":"27","messages":"28","suppressedMessages":"29","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"30","messages":"31","suppressedMessages":"32","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/index.js",[],[],"/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/App.js",[],[],"/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/reportWebVitals.js",[],[],"/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/ChatUi.js",["33"],[],"import React, { useState, useEffect, useRef } from \"react\";\nimport SocketConnection from \"./SocketConnection\";\nimport {\n  Container,\n  HistoryBoxContainer,\n  UserBox,\n  LogoBtn,\n  NameDiv,\n  RoomBox,\n  SendMsg,\n  Input,\n  InputDiv,\n  SendBtn,\n  GetMsg,\n  HistoryBox,\n} from \"./style\";\n\nconst ChatUi = () => {\n  const [data, setData] = useState([]);\n  const [mas, setMas] = useState([]);\n  const [userId, setUserId] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  // const [activeRoomMessages, setActiveRoomMessages] = useState([]);\n  // const activeRoomMessagesRef = useRef();\n  const token =\n    \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjNiYmQ1ZWY3NDVhNmNmNTE5ZWE3ZDQyIiwiaWF0IjoxNjc0MTMxNzU1LCJleHAiOjE2NzY3MjM3NTV9.4-kTHPyMq1DYGsBgm2fGnOETVyCKpAUS5-DKWqyiGlU\";\n  const fetchData = () => {\n    fetch(\n      \"http://172.105.41.247:5004/api/v1/chats?page_no=1&limit=10&user_id=63bbd5ef745a6cf519ea7d42\",\n      {\n        method: \"GET\",\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    )\n      .then((res) => res.json())\n      .then((result) => {\n        setData(result.result.data);\n        console.log(result.result.data);\n      });\n  };\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchHistory = (id) => {\n    // setUserId(id);\n    // console.log(id, \"kidddddddddd\");\n    const token =\n      \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjNiZTRkMjE4MGRkMjFiMjM4ZTdjMjRmIiwiaWF0IjoxNjczODc0MjU3LCJleHAiOjE2NzY0NjYyNTd9.YHZjuuIiWINgNbk94YNO5nbl0vjc3a6sXIxsGGuBgHA\";\n    fetch(\n      `http://172.105.41.247:5004/api/v1/chats/${id}?page_no=1&page_size=10`,\n      {\n        method: \"GET\",\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    )\n      .then((res) => res.json())\n      .then((result) => {\n        setMas(result.result.data.reverse());\n\n        // console.log(result.result.data, \"text messages_____--------__----\");\n      });\n  };\n\n  const pushMsg = () => {\n    // console.log(userId, \"iddddddddd\");\n    let data = new FormData();\n    data.append(\"to_send\", userId);\n    data.append(\"message\", message);\n    data.append(\"is_file\", false);\n    // data.append(\"send_to_role\", \"vendor\");\n    const token =\n      \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjNiYmQ1ZWY3NDVhNmNmNTE5ZWE3ZDQyIiwiaWF0IjoxNjc0NjI2OTE3LCJleHAiOjE2NzcyMTg5MTd9.MZ6406QOHM2HBCGbAGX9-y0h-U4cdC9fuosFUw_NSfA\";\n    fetch(\"http://172.105.41.247:5004/api/v1/chats/send_message\", {\n      method: \"POST\",\n      headers: { Authorization: `Bearer ${token}` },\n      body: data,\n    });\n  };\n\n  const handleReceivedMessage = (event) => {\n    const newMsg = JSON.parse(event);\n    const newMsg1 = newMsg.data.message;\n    // setActiveRoomMessages(event);\n    // data.map((elm) => {\n    // if (elm._id === newMsg.data.chat._id) {\n    // console.log(data, \"sam and push message\");\n    // }\n    // });\n    const token =\n      \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjNiZTRkMjE4MGRkMjFiMjM4ZTdjMjRmIiwiaWF0IjoxNjczODc0MjU3LCJleHAiOjE2NzY0NjYyNTd9.YHZjuuIiWINgNbk94YNO5nbl0vjc3a6sXIxsGGuBgHA\";\n    fetch(\n      `http://172.105.41.247:5004/api/v1/chats/${newMsg.data.chat._id}?page_no=1&page_size=10`,\n      {\n        method: \"GET\",\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    )\n      .then((res) => res.json())\n      .then((result) => {\n        // setMas(result.result.data.reverse());\n        const oldMsg = result.result.data;\n        oldMsg.push(newMsg1);\n        fetchHistory(newMsg.data.chat._id);\n        // console.log(oldMsg, \"text messages_____--------__----\");\n      });\n  };\n  return (\n    <div>\n      <SocketConnection handleReceivedMessage={handleReceivedMessage} />\n      <Container>\n        <RoomBox>\n          {data.map((elm) => {\n            return (\n              <>\n                <UserBox\n                  onClick={() => {\n                    fetchHistory(elm._id);\n                    setUserId(\n                      elm.members[0] === \"63bbd5ef745a6cf519ea7d42\"\n                        ? elm.members[1]\n                        : elm.members[0]\n                    );\n                    setUserId(elm.member_users[1]._id);\n                    // console.log(elm.members[0], \"RoomUser id\");\n                  }}\n                >\n                  <LogoBtn>\n                    {elm.member_users[1]?.first_name.match(/\\b(\\w)/g)}\n                  </LogoBtn>\n                  <NameDiv>\n                    <p>\n                      <span style={{ fontSize: \"20px\" }}>\n                        {elm.member_users[1].first_name}\n                      </span>\n                      <br />\n                      {elm.last_message.message}\n                    </p>\n                  </NameDiv>\n                </UserBox>\n              </>\n            );\n          })}\n        </RoomBox>\n        <HistoryBoxContainer>\n          <HistoryBox>\n            {mas.map((elm) => {\n              // console.log(elm.sender_user._id, \"uuuuuu\");\n              return elm.sender_user._id !== userId ? (\n                <SendMsg>{elm.message}</SendMsg>\n              ) : (\n                <GetMsg>{elm.message}</GetMsg>\n              );\n            })}\n          </HistoryBox>\n          <InputDiv>\n            <Input\n              type=\"text\"\n              onChange={(event) => {\n                setMessage(event.target.value);\n              }}\n            />\n            <SendBtn\n              onClick={() => {\n                pushMsg();\n              }}\n            >\n              <strong>send</strong>\n            </SendBtn>\n          </InputDiv>\n        </HistoryBoxContainer>\n      </Container>\n    </div>\n  );\n};\nexport default ChatUi;\n","/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/SocketConnection.js",["34"],[],"/home/deorwine/Desktop/chat aplication/my-app/chataplication/src/style.js",[],[],{"ruleId":"35","severity":1,"message":"36","line":1,"column":38,"nodeType":"37","messageId":"38","endLine":1,"endColumn":44},{"ruleId":"39","severity":1,"message":"40","line":26,"column":6,"nodeType":"41","endLine":26,"endColumn":8,"suggestions":"42"},"no-unused-vars","'useRef' is defined but never used.","Identifier","unusedVar","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'handleReceivedMessage'. Either include it or remove the dependency array. If 'handleReceivedMessage' changes too often, find the parent component that defines it and wrap that definition in useCallback.","ArrayExpression",["43"],{"desc":"44","fix":"45"},"Update the dependencies array to be: [handleReceivedMessage]",{"range":"46","text":"47"},[674,676],"[handleReceivedMessage]"]